#!/bin/sh
# exprot variables
export VARC=""
export VARH=""
# generate content
VARC="# autogenerated apache conf\n"
VARH="<html style='height: 100%;'>\n<body style='text-align: center;'>\n <h1>/var/www/html/index.html</h1>\n <p>This ist the Index of Peter's project setup.</p>\n <a href='http://localhost:8080'>npm host</a><br/>\n <a href='http://localhost/phpmyadmin/index.php'>phpmyadmin</a><br/>\n <a href='http://lcoalhost:8000'>php host</a><br/>\n <p>Note: Local WP Sites are not listed here since apache and local can not run simultaneously.</p>\n <h1>/var/www/vhosts/*/</h1>\n <p>This are all the autogenerated hosts for all projects in /var/www/vhosts/</p>\n"
for i in `ls /var/www/vhosts/`; do
VARC="${VARC}<VirtualHost *:80>\n Options +FollowSymLinks -SymLinksIfOwnerMatch\n DocumentRoot /var/www/vhosts/${i}/public\n ServerName ${i}.localhost\n <Directory "/var/www/vhosts/${i}/public/">\n AllowOverride ALL\n </Directory>\n ErrorLog \${APACHE_LOG_DIR}/vhost-${i}-error.log\n CustomLog \${APACHE_LOG_DIR}/vhosts-${i}-requests.log combined\n</VirtualHost>\n"
VARH="${VARH} <a href='http://${i}.localhost'>${i}.localhost</a><br/>\n";
done;
VARH="${VARH}<body/>\n<html/>\n"
# save content
echo $VARC > /etc/apache2/sites-available/vhosts.conf
echo $VARH > /var/www/html/index.html
sudo systemctl restart apache2.service
